import{a as G}from"./chunk-3S6KNALJ.js";import{a as X,b as C}from"./chunk-P4PAYY2C.js";import{a as z}from"./chunk-ZTRCDHQG.js";import{a as B}from"./chunk-H6WS2JFF.js";import{b as N,c as W,f as O,i as j,j as A,k as P,p as H}from"./chunk-BIJEMQVT.js";import"./chunk-O5HRWX2F.js";import{$a as h,Db as I,Eb as L,Ga as b,Hb as D,Ia as d,Ma as e,Na as t,Oa as u,Qa as c,Ra as R,W as M,Wa as i,Xa as v,Ya as y,Za as F,ab as _,bb as x,db as k,ea as g,fa as f,wa as a,xa as S}from"./chunk-SFQMZB6G.js";import{h as E}from"./chunk-FK42CRUA.js";function K(m,l){if(m&1&&(e(0,"option",32),i(1),t()),m&2){let o=l.$implicit;d("value",o.id_cliente),a(),y(" ",o.nombre," ")}}function Q(m,l){if(m&1&&(e(0,"option",32),i(1),t()),m&2){let o=l.$implicit;d("value",o.id_usuario),a(),y(" ",o.nombre_usuario," ")}}function Y(m,l){if(m&1&&(e(0,"tr",33)(1,"td",34),i(2),t(),e(3,"td",35),i(4),t(),e(5,"td",36),i(6),t(),e(7,"td",34)(8,"span",37),i(9),t()(),e(10,"td",38),i(11),t(),e(12,"td",34),i(13),t()()),m&2){let o=l.$implicit,n=R();a(2),v(n.formatFecha(o.fecha)),a(2),v((o.clientes==null?null:o.clientes.nombre)||"---"),a(2),v((o.clientes==null?null:o.clientes.documento)||"---"),a(3),F(" ",o.tipo_comprobante," ",o.nro_comprobante||""," "),a(2),y("S/ ",(o.total||0).toFixed(2),""),a(2),v((o.usuarios==null?null:o.usuarios.nombre_usuario)||"---")}}function Z(m,l){m&1&&(e(0,"tr")(1,"td",39),g(),e(2,"svg",40),u(3,"path",41),t(),f(),e(4,"p",42),i(5,"No hay ventas para los filtros seleccionados"),t()()())}var U=class m{constructor(l,o,n){this.ventasService=l;this.clientesService=o;this.usuariosService=n}ventas=[];clientes=[];usuarios=[];filtros={fecha_inicio:"",fecha_fin:"",id_cliente:"",id_usuario:"",tipo_comprobante:""};ngOnInit(){return E(this,null,function*(){this.clientes=yield this.clientesService.getClientes(),this.usuarios=yield this.usuariosService.getUsuarios(),yield this.cargarReporte()})}cargarReporte(){return E(this,null,function*(){let l={fecha_inicio:this.filtros.fecha_inicio||void 0,fecha_fin:this.filtros.fecha_fin||void 0,id_cliente:this.filtros.id_cliente?Number(this.filtros.id_cliente):void 0,id_usuario:this.filtros.id_usuario||void 0,tipo_comprobante:this.filtros.tipo_comprobante||void 0};this.ventas=yield this.ventasService.getReporteVentas(l)})}formatFecha(l){return new Date(l).toLocaleString()}exportarPDF(){console.log("Exportar PDF a\xFAn no implementado")}exportarExcel(){try{if(this.ventas.length===0){alert("No hay ventas para exportar.");return}let l=this.ventas.map(s=>({Fecha:this.formatFecha(s.fecha),Cliente:s.clientes?.nombre||"---",Documento:s.clientes?.documento||"---","Tipo Comprobante":s.tipo_comprobante||"","N\xFAmero Comprobante":s.nro_comprobante||"",Total:s.total||0,Cajero:s.usuarios?.nombre_usuario||"---"})),o=new Date().toLocaleString("es-PE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),n=this.ventas.reduce((s,J)=>s+(J.total||0),0),p=["Fecha","Cliente","Documento","Tipo Comprobante","N\xFAmero Comprobante","Total","Cajero"],r=[["REPORTE DE VENTAS"],["FERRETER\xCDA RHEMA"],[`Fecha de Exportaci\xF3n: ${o}`],[`Total de Ventas: ${this.ventas.length}`],[`Monto Total: S/ ${n.toFixed(2)}`],[],p,...l.map(s=>[s.Fecha,s.Cliente,s.Documento,s["Tipo Comprobante"],s["N\xFAmero Comprobante"],s.Total,s.Cajero])],w=C.book_new(),V=C.aoa_to_sheet(r),q=[{wch:20},{wch:30},{wch:15},{wch:18},{wch:20},{wch:15},{wch:20}];V["!cols"]=q,C.book_append_sheet(w,V,"Ventas");let T=`reporte_ventas_${new Date().toISOString().split("T")[0]}.xlsx`;X(w,T),alert(`Archivo Excel exportado correctamente: ${T}

Total de ventas: ${this.ventas.length}
Monto total: S/ ${n.toFixed(2)}`)}catch(l){console.error("Error al exportar a Excel:",l),alert("Error al exportar el archivo Excel. Por favor, intente nuevamente.")}}static \u0275fac=function(o){return new(o||m)(S(B),S(z),S(G))};static \u0275cmp=M({type:m,selectors:[["app-ventas-reporte"]],standalone:!0,features:[k],decls:80,vars:9,consts:[[1,"p-4","md:p-6","space-y-6"],[1,"text-2xl","font-bold","text-gray-800","flex","items-center","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],[1,"text-gray-600","mt-1"],[1,"bg-white","p-5","rounded-xl","shadow-sm","border","border-gray-200"],[1,"flex","items-center","gap-2","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"],[1,"text-sm","font-semibold","text-gray-500","uppercase","tracking-wide"],[1,"grid","grid-cols-1","sm:grid-cols-3","lg:grid-cols-5","gap-4"],[1,"flex","flex-col"],[1,"text-sm","font-medium","text-gray-700","mb-1"],["type","date",1,"border","rounded-lg","px-3","py-2","text-sm","focus:ring-2","focus:ring-blue-500","focus:outline-none",3,"ngModelChange","change","ngModel"],[1,"border","rounded-lg","px-3","py-2","text-sm","bg-white","focus:ring-2","focus:ring-blue-500","focus:outline-none",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"flex","items-center","justify-between","mb-4"],[1,"flex","gap-2"],[1,"flex","items-center","gap-2","px-4","py-2","rounded-lg","bg-green-600","text-white","font-medium","text-sm","hover:bg-green-700","transition-colors","shadow-sm",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"flex","items-center","gap-2","px-4","py-2","rounded-lg","bg-red-600","text-white","font-medium","text-sm","hover:bg-red-700","transition-colors","shadow-sm",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"],[1,"overflow-x-auto"],[1,"w-full","min-w-[800px]","border-collapse"],[1,"bg-gray-100","text-sm","text-gray-600"],[1,"px-4","py-3","text-left","font-semibold"],[1,"px-4","py-3","text-right","font-semibold"],[1,"text-sm"],["class","border-b hover:bg-gray-50 transition-colors",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],[1,"border-b","hover:bg-gray-50","transition-colors"],[1,"px-4","py-3","text-gray-700"],[1,"px-4","py-3","font-medium","text-gray-900"],[1,"px-4","py-3","text-gray-600"],[1,"inline-flex","items-center","px-2","py-1","rounded","text-xs","font-medium","bg-blue-50","text-blue-700"],[1,"px-4","py-3","text-right","font-semibold","text-green-600"],["colspan","6",1,"text-center","text-gray-500","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","mx-auto","mb-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"text-sm","font-medium"]],template:function(o,n){o&1&&(e(0,"div",0)(1,"div")(2,"h1",1),g(),e(3,"svg",2),u(4,"path",3),t(),i(5," Reporte de Ventas "),t(),f(),e(6,"p",4),i(7,"Consulta y analiza las ventas realizadas en el sistema."),t()(),e(8,"div",5)(9,"div",6),g(),e(10,"svg",7),u(11,"path",8),t(),f(),e(12,"h3",9),i(13,"Filtros"),t()(),e(14,"div",10)(15,"div",11)(16,"label",12),i(17,"Desde"),t(),e(18,"input",13),x("ngModelChange",function(r){return _(n.filtros.fecha_inicio,r)||(n.filtros.fecha_inicio=r),r}),c("change",function(){return n.cargarReporte()}),t()(),e(19,"div",11)(20,"label",12),i(21,"Hasta"),t(),e(22,"input",13),x("ngModelChange",function(r){return _(n.filtros.fecha_fin,r)||(n.filtros.fecha_fin=r),r}),c("change",function(){return n.cargarReporte()}),t()(),e(23,"div",11)(24,"label",12),i(25,"Cliente"),t(),e(26,"select",14),x("ngModelChange",function(r){return _(n.filtros.id_cliente,r)||(n.filtros.id_cliente=r),r}),c("change",function(){return n.cargarReporte()}),e(27,"option",15),i(28,"Todos"),t(),b(29,K,2,2,"option",16),t()(),e(30,"div",11)(31,"label",12),i(32,"Cajero"),t(),e(33,"select",14),x("ngModelChange",function(r){return _(n.filtros.id_usuario,r)||(n.filtros.id_usuario=r),r}),c("change",function(){return n.cargarReporte()}),e(34,"option",15),i(35,"Todos"),t(),b(36,Q,2,2,"option",16),t()(),e(37,"div",11)(38,"label",12),i(39,"Comprobante"),t(),e(40,"select",14),x("ngModelChange",function(r){return _(n.filtros.tipo_comprobante,r)||(n.filtros.tipo_comprobante=r),r}),c("change",function(){return n.cargarReporte()}),e(41,"option",15),i(42,"Todos"),t(),e(43,"option"),i(44,"BOLETA"),t(),e(45,"option"),i(46,"FACTURA"),t(),e(47,"option"),i(48,"NOTA DE VENTA"),t()()()()(),e(49,"div",17),u(50,"div"),e(51,"div",18)(52,"button",19),c("click",function(){return n.exportarExcel()}),g(),e(53,"svg",20),u(54,"path",21),t(),i(55," Exportar Excel "),t(),f(),e(56,"button",22),c("click",function(){return n.exportarPDF()}),g(),e(57,"svg",20),u(58,"path",23),t(),i(59," Exportar PDF "),t()()(),f(),e(60,"div",5)(61,"div",24)(62,"table",25)(63,"thead",26)(64,"tr")(65,"th",27),i(66,"Fecha"),t(),e(67,"th",27),i(68,"Cliente"),t(),e(69,"th",27),i(70,"Documento"),t(),e(71,"th",27),i(72,"Comprobante"),t(),e(73,"th",28),i(74,"Total"),t(),e(75,"th",27),i(76,"Cajero"),t()()(),e(77,"tbody",29),b(78,Y,14,7,"tr",30)(79,Z,6,0,"tr",31),t()()()()()),o&2&&(a(18),h("ngModel",n.filtros.fecha_inicio),a(4),h("ngModel",n.filtros.fecha_fin),a(4),h("ngModel",n.filtros.id_cliente),a(3),d("ngForOf",n.clientes),a(4),h("ngModel",n.filtros.id_usuario),a(3),d("ngForOf",n.usuarios),a(4),h("ngModel",n.filtros.tipo_comprobante),a(38),d("ngForOf",n.ventas),a(),d("ngIf",n.ventas.length===0))},dependencies:[D,I,L,H,A,P,N,j,W,O],encapsulation:2})};export{U as VentasReporteComponent};
