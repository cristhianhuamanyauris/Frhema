import{a as $}from"./chunk-44D34TD6.js";import{a as U,b as _}from"./chunk-P4PAYY2C.js";import{b as W,c as X,f as z,i as A,j,k as B,p as G}from"./chunk-BIJEMQVT.js";import"./chunk-O5HRWX2F.js";import{$a as y,Db as L,Eb as O,Ga as f,Gb as N,Hb as H,Ia as c,Ma as e,Na as t,Oa as u,Pa as T,Qa as S,Ra as h,W as F,Wa as o,Xa as x,Ya as v,ab as b,bb as C,ca as w,da as M,db as V,ea as m,fa as g,gb as I,hb as D,wa as i,xa as P}from"./chunk-SFQMZB6G.js";import{h as E}from"./chunk-FK42CRUA.js";function K(d,a){if(d&1&&(e(0,"option",15),o(1),t()),d&2){let n=a.$implicit;c("ngValue",n.id_proveedor),i(),v(" ",n.nombre," ")}}function Q(d,a){if(d&1){let n=T();e(0,"div",30)(1,"div",31)(2,"span",32),o(3,"Total: "),t(),e(4,"span",33),o(5),I(6,"currency"),t()(),e(7,"div",34)(8,"button",35),S("click",function(){w(n);let p=h();return M(p.exportarExcel())}),m(),e(9,"svg",18),u(10,"path",36),t(),o(11," Exportar Excel "),t(),g(),e(12,"button",37),S("click",function(){w(n);let p=h();return M(p.exportarPDF())}),m(),e(13,"svg",18),u(14,"path",38),t(),o(15," Exportar PDF "),t()()()}if(d&2){let n=h();i(5),x(D(6,1,n.totalComprado,"PEN"))}}function Y(d,a){if(d&1&&(e(0,"tr",39)(1,"td",40),o(2),t(),e(3,"td",41),o(4),t(),e(5,"td",42),o(6),t(),e(7,"td",40),o(8),t(),e(9,"td",43),o(10),t(),e(11,"td",44),o(12),t(),e(13,"td",45),o(14),t()()),d&2){let n=a.$implicit,r=h();i(2),x(r.formatear(n.fecha)),i(2),x(n.proveedor),i(2),x(n.nro_documento||"\u2014"),i(2),x(n.producto),i(2),x(n.cantidad),i(2),v("S/ ",(n.costo_unitario||0).toFixed(2),""),i(2),v(" S/ ",(n.subtotal||0).toFixed(2)," ")}}function Z(d,a){d&1&&(e(0,"tr")(1,"td",46),m(),e(2,"svg",47),u(3,"path",3),t(),g(),e(4,"p",48),o(5,"No hay compras para los filtros seleccionados"),t(),e(6,"p",49),o(7,'Selecciona filtros y haz clic en "Generar Reporte"'),t()()())}var q=class d{constructor(a){this.reportesService=a}desde="";hasta="";proveedorSeleccionado=null;proveedores=[];resultados=[];totalComprado=0;ngOnInit(){return E(this,null,function*(){this.proveedores=yield this.reportesService.getProveedores()})}filtrar(){return E(this,null,function*(){let a=yield this.reportesService.getComprasReporte(this.desde,this.hasta,this.proveedorSeleccionado);this.resultados=a.resultados,this.totalComprado=a.total})}formatear(a){return new Date(a).toLocaleDateString("es-PE")}exportarExcel(){try{if(this.resultados.length===0){alert("No hay compras para exportar.");return}let a=this.resultados.map(l=>({Fecha:this.formatear(l.fecha),Proveedor:l.proveedor||"---",Documento:l.nro_documento||"---",Producto:l.producto||"---",Cantidad:l.cantidad||0,"Costo Unitario":l.costo_unitario||0,Subtotal:l.subtotal||0})),n=new Date().toLocaleString("es-PE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),r=["Fecha","Proveedor","Documento","Producto","Cantidad","Costo Unitario","Subtotal"],p=[["REPORTE DE COMPRAS"],["FERRETER\xCDA RHEMA"],[`Fecha de Exportaci\xF3n: ${n}`],[`Total de Registros: ${this.resultados.length}`],[`Monto Total: S/ ${this.totalComprado.toFixed(2)}`],[],r,...a.map(l=>[l.Fecha,l.Proveedor,l.Documento,l.Producto,l.Cantidad,l["Costo Unitario"],l.Subtotal])],s=_.book_new(),k=_.aoa_to_sheet(p),J=[{wch:12},{wch:25},{wch:15},{wch:30},{wch:12},{wch:15},{wch:15}];k["!cols"]=J,_.book_append_sheet(s,k,"Compras");let R=`reporte_compras_${new Date().toISOString().split("T")[0]}.xlsx`;U(s,R),alert(`Archivo Excel exportado correctamente: ${R}

Total de registros: ${this.resultados.length}
Monto total: S/ ${this.totalComprado.toFixed(2)}`)}catch(a){console.error("Error al exportar a Excel:",a),alert("Error al exportar el archivo Excel. Por favor, intente nuevamente.")}}exportarPDF(){console.log("Exportar PDF a\xFAn no implementado")}static \u0275fac=function(n){return new(n||d)(P($))};static \u0275cmp=F({type:d,selectors:[["app-compras-reporte"]],standalone:!0,features:[V],decls:57,vars:8,consts:[[1,"p-4","md:p-6","space-y-6"],[1,"text-2xl","font-bold","text-gray-800","flex","items-center","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"],[1,"text-gray-600","mt-1"],[1,"bg-white","p-5","rounded-xl","shadow-sm","border","border-gray-200"],[1,"flex","items-center","gap-2","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"],[1,"text-sm","font-semibold","text-gray-500","uppercase","tracking-wide"],[1,"grid","grid-cols-1","sm:grid-cols-3","gap-4","mb-4"],[1,"flex","flex-col"],[1,"text-sm","font-medium","text-gray-700","mb-1"],["type","date",1,"w-full","border","border-gray-300","rounded-lg","px-3","py-2","text-sm","bg-white","focus:ring-2","focus:ring-blue-500","focus:outline-none",3,"ngModelChange","ngModel"],[1,"w-full","border","border-gray-300","rounded-lg","px-3","py-2","text-sm","bg-white","focus:ring-2","focus:ring-blue-500","focus:outline-none",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"flex","items-center","gap-2","px-4","py-2","bg-blue-600","text-white","font-medium","text-sm","rounded-lg","hover:bg-blue-700","transition-colors","shadow-sm",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["class","flex items-center justify-between mb-4",4,"ngIf"],[1,"overflow-x-auto"],[1,"w-full","min-w-[800px]","border-collapse"],[1,"bg-gray-100","text-sm","text-gray-600"],[1,"px-4","py-3","text-left","font-semibold"],[1,"px-4","py-3","text-center","font-semibold"],[1,"px-4","py-3","text-right","font-semibold"],[1,"text-sm"],["class","border-b hover:bg-gray-50 transition-colors",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-sm","text-gray-600"],[1,"font-semibold","text-gray-800"],[1,"text-lg","font-bold","text-blue-600"],[1,"flex","gap-2"],[1,"flex","items-center","gap-2","px-4","py-2","rounded-lg","bg-green-600","text-white","font-medium","text-sm","hover:bg-green-700","transition-colors","shadow-sm",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"flex","items-center","gap-2","px-4","py-2","rounded-lg","bg-red-600","text-white","font-medium","text-sm","hover:bg-red-700","transition-colors","shadow-sm",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"],[1,"border-b","hover:bg-gray-50","transition-colors"],[1,"px-4","py-3","text-gray-700"],[1,"px-4","py-3","font-medium","text-gray-900"],[1,"px-4","py-3","text-gray-600"],[1,"px-4","py-3","text-center","text-gray-700"],[1,"px-4","py-3","text-right","text-gray-700"],[1,"px-4","py-3","text-right","font-semibold","text-blue-600"],["colspan","7",1,"text-center","text-gray-500","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","mx-auto","mb-4","text-gray-400"],[1,"text-sm","font-medium"],[1,"text-xs","text-gray-400","mt-1"]],template:function(n,r){n&1&&(e(0,"div",0)(1,"div")(2,"h1",1),m(),e(3,"svg",2),u(4,"path",3),t(),o(5," Reporte de Compras "),t(),g(),e(6,"p",4),o(7,"Consulta y analiza las compras realizadas a proveedores."),t()(),e(8,"div",5)(9,"div",6),m(),e(10,"svg",7),u(11,"path",8),t(),g(),e(12,"h3",9),o(13,"Filtros"),t()(),e(14,"div",10)(15,"div",11)(16,"label",12),o(17,"Desde"),t(),e(18,"input",13),C("ngModelChange",function(s){return b(r.desde,s)||(r.desde=s),s}),t()(),e(19,"div",11)(20,"label",12),o(21,"Hasta"),t(),e(22,"input",13),C("ngModelChange",function(s){return b(r.hasta,s)||(r.hasta=s),s}),t()(),e(23,"div",11)(24,"label",12),o(25,"Proveedor"),t(),e(26,"select",14),C("ngModelChange",function(s){return b(r.proveedorSeleccionado,s)||(r.proveedorSeleccionado=s),s}),e(27,"option",15),o(28,"Todos"),t(),f(29,K,2,2,"option",16),t()()(),e(30,"button",17),S("click",function(){return r.filtrar()}),m(),e(31,"svg",18),u(32,"path",19),t(),o(33," Generar Reporte "),t()(),f(34,Q,16,4,"div",20),g(),e(35,"div",5)(36,"div",21)(37,"table",22)(38,"thead",23)(39,"tr")(40,"th",24),o(41,"Fecha"),t(),e(42,"th",24),o(43,"Proveedor"),t(),e(44,"th",24),o(45,"Documento"),t(),e(46,"th",24),o(47,"Producto"),t(),e(48,"th",25),o(49,"Cantidad"),t(),e(50,"th",26),o(51,"Costo Unit."),t(),e(52,"th",26),o(53,"Subtotal"),t()()(),e(54,"tbody",27),f(55,Y,15,7,"tr",28)(56,Z,8,0,"tr",29),t()()()()()),n&2&&(i(18),y("ngModel",r.desde),i(4),y("ngModel",r.hasta),i(4),y("ngModel",r.proveedorSeleccionado),i(),c("ngValue",null),i(2),c("ngForOf",r.proveedores),i(5),c("ngIf",r.resultados.length>0),i(21),c("ngForOf",r.resultados),i(),c("ngIf",r.resultados.length===0))},dependencies:[H,L,O,N,G,j,B,W,A,X,z],encapsulation:2})};export{q as ComprasReporteComponent};
