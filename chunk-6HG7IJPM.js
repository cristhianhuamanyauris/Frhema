import{a as R}from"./chunk-H6WS2JFF.js";import{b as z,c as G,f as W,p as A}from"./chunk-BIJEMQVT.js";import"./chunk-O5HRWX2F.js";import{$a as C,Db as L,Eb as P,Fb as B,Ga as _,Hb as O,Ia as y,Ma as e,Na as t,Oa as v,Pa as w,Qa as c,Ra as f,Va as M,W as F,Wa as n,Xa as p,Ya as b,Za as H,ab as E,bb as k,ca as d,da as m,db as T,ea as g,fa as u,gb as V,hb as D,ib as N,jb as j,wa as a,xa as I}from"./chunk-SFQMZB6G.js";import{h as S}from"./chunk-FK42CRUA.js";function J(l,r){l&1&&(e(0,"div",21),n(1,"Cargando ventas..."),t())}function K(l,r){if(l&1){let i=w();e(0,"tr",25)(1,"td",26),n(2),t(),e(3,"td",26),n(4),V(5,"date"),t(),e(6,"td",27),n(7),t(),e(8,"td",28),n(9),t(),e(10,"td",29),n(11),t(),e(12,"td",30)(13,"div",31)(14,"button",32),c("click",function(){let s=d(i).$implicit,h=f(2);return m(h.verDetalle(s))}),g(),e(15,"svg",33),v(16,"path",34)(17,"path",35),t(),u(),e(18,"span"),n(19,"Ver detalle"),t()()()()()}if(l&2){let i=r.$implicit;a(2),p(i.id_venta),a(2),p(N(5,6,i.fecha,"short","-10:00")),a(3),p((i.clientes==null?null:i.clientes.nombre)||"Sin cliente"),a(2),H("",i.tipo_comprobante," ",i.nro_comprobante,""),a(2),b("S/. ",i.total,"")}}function Q(l,r){if(l&1&&(e(0,"table",22)(1,"thead")(2,"tr")(3,"th",23),n(4,"ID"),t(),e(5,"th",23),n(6,"Fecha"),t(),e(7,"th",23),n(8,"Cliente"),t(),e(9,"th",23),n(10,"Comprobante"),t(),e(11,"th",23),n(12,"Total"),t(),e(13,"th",23),n(14,"Acciones"),t()()(),e(15,"tbody"),_(16,K,20,10,"tr",24),t()()),l&2){let i=f();a(16),y("ngForOf",i.ventasFiltradas)}}function U(l,r){l&1&&(e(0,"div",36),g(),e(1,"svg",37),v(2,"path",6),t(),u(),e(3,"h3",38),n(4,"No hay ventas registradas"),t(),e(5,"p",39),n(6,"Las ventas realizadas aparecer\xE1n aqu\xED."),t()())}function X(l,r){if(l&1&&(e(0,"tr",67)(1,"td",68),n(2),t(),e(3,"td",69),n(4),t(),e(5,"td",69),n(6),t(),e(7,"td",69),n(8),t(),e(9,"td",70),n(10),t()()),l&2){let i=r.$implicit;a(2),p(i.productos==null?null:i.productos.nombre),a(2),p(i.cantidad),a(2),b("S/. ",i.precio_unitario,""),a(2),b("S/. ",i.descuento,""),a(2),b("S/. ",i.subtotal,"")}}function Y(l,r){if(l&1){let i=w();e(0,"div",40),c("click",function(){d(i);let s=f();return m(s.cerrarDetalle())}),e(1,"div",41),c("click",function(s){return d(i),m(s.stopPropagation())}),e(2,"div",42)(3,"div",43)(4,"h3",44),n(5),t(),e(6,"button",45),c("click",function(){d(i);let s=f();return m(s.cerrarDetalle())}),g(),e(7,"svg",46),v(8,"path",47),t()()()(),u(),e(9,"div",48)(10,"div",49)(11,"div",50)(12,"p",51),n(13,"Cliente"),t(),e(14,"p",52),n(15),t()(),e(16,"div",50)(17,"p",51),n(18,"Fecha"),t(),e(19,"p",52),n(20),V(21,"date"),t()(),e(22,"div",53)(23,"p",54),n(24,"Total"),t(),e(25,"p",55),n(26),t()()(),e(27,"div",56)(28,"h4",57),n(29,"Productos"),t(),e(30,"div",58)(31,"table",59)(32,"thead")(33,"tr",60)(34,"th",61),n(35,"Producto"),t(),e(36,"th",61),n(37,"Cant."),t(),e(38,"th",61),n(39,"Precio"),t(),e(40,"th",61),n(41,"Desc."),t(),e(42,"th",61),n(43,"Subtotal"),t()()(),e(44,"tbody",62),_(45,X,11,5,"tr",63),t()()()(),e(46,"div",64)(47,"button",65),c("click",function(){d(i);let s=f();return m(s.cerrarDetalle())}),g(),e(48,"svg",66),v(49,"path",47),t(),u(),e(50,"span"),n(51,"Cerrar"),t()()()()()()}if(l&2){let i=f();a(5),b("Detalle de Venta #",i.ventaSeleccionada==null?null:i.ventaSeleccionada.id_venta,""),a(10),p((i.ventaSeleccionada==null||i.ventaSeleccionada.clientes==null?null:i.ventaSeleccionada.clientes.nombre)||"-"),a(5),p(D(21,5,i.ventaSeleccionada==null?null:i.ventaSeleccionada.fecha,"short")),a(6),b("S/. ",i.ventaSeleccionada==null?null:i.ventaSeleccionada.total,""),a(19),y("ngForOf",i.detalle)}}var q=class l{constructor(r){this.ventasService=r}ventas=[];ventasFiltradas=[];detalle=[];mostrandoDetalle=!1;ventaSeleccionada=null;filtroNombre="";filtroFecha="";loading=!0;ngOnInit(){return S(this,null,function*(){yield this.cargarVentas()})}cargarVentas(){return S(this,null,function*(){this.loading=!0;let r=yield this.ventasService.getVentas();this.ventas=Array.isArray(r)?r:[],this.ventasFiltradas=[...this.ventas],this.loading=!1})}filtrarPorNombre(){let r=this.filtroNombre.toLowerCase().trim();if(!r){this.ventasFiltradas=[...this.ventas];return}this.ventasFiltradas=this.ventas.filter(i=>i.clientes?.nombre?.toLowerCase().includes(r))}filtrarPorFecha(){let r=this.filtroFecha.trim();if(!r){this.ventasFiltradas=[...this.ventas];return}this.ventasFiltradas=this.ventas.filter(i=>i.fecha?.substring(0,10)===r)}limpiarFiltros(){this.filtroNombre="",this.filtroFecha="",this.ventasFiltradas=[...this.ventas]}verDetalle(r){return S(this,null,function*(){this.ventaSeleccionada=r,this.detalle=yield this.ventasService.getDetalle(r.id_venta),this.mostrandoDetalle=!0})}cerrarDetalle(){this.mostrandoDetalle=!1,this.detalle=[],this.ventaSeleccionada=null}static \u0275fac=function(i){return new(i||l)(I(R))};static \u0275cmp=F({type:l,selectors:[["app-historial"]],standalone:!0,features:[T],decls:28,vars:6,consts:[["sinDatos",""],[1,"w-full","max-w-[1200px]","mx-auto","flex","flex-col","px-2","md:px-3","pb-2"],[1,"flex","items-start","justify-between","gap-4","px-0","py-3","pb-2","bg-transparent","border-none","shadow-none"],[1,"flex-1"],[1,"flex","items-center","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"m-0","text-2xl","font-semibold","text-gray-900","tracking-wide"],[1,"mt-1","mb-0","text-sm","text-gray-600"],[1,"flex","items-center","justify-between","px-0","py-1.5","mb-1.5","border-b","border-gray-200"],[1,"flex","items-center","text-gray-900","text-xs","font-semibold","uppercase","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"],[1,"flex","gap-3","mb-4"],["type","text","placeholder","Buscar por cliente",1,"border","p-2","rounded","w-64",3,"ngModelChange","input","ngModel"],["type","date",1,"border","p-2","rounded",3,"ngModelChange","change","ngModel"],[1,"bg-gray-500","text-white","px-4","py-2","rounded",3,"click"],[1,"rounded-none","border-none","bg-transparent","overflow-auto","shadow-none","px-0","pb-2"],["class","p-6 text-center text-gray-500",4,"ngIf"],["class","w-full border-collapse min-w-[960px]",4,"ngIf","ngIfElse"],["class","fixed inset-0 z-[2000] bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center p-4",3,"click",4,"ngIf"],[1,"p-6","text-center","text-gray-500"],[1,"w-full","border-collapse","min-w-[960px]"],[1,"text-left","text-xs","tracking-wider","uppercase","text-gray-600","py-3.5","px-4","bg-transparent","sticky","top-0","border-b","border-gray-200","font-semibold"],["class","hover:bg-blue-50 transition-colors",4,"ngFor","ngForOf"],[1,"hover:bg-blue-50","transition-colors"],[1,"py-4","px-4","border-b","border-gray-100","align-middle","text-gray-600","text-sm"],[1,"py-4","px-4","border-b","border-gray-100","align-middle","text-gray-900","text-sm"],[1,"py-4","px-4","border-b","border-gray-100","align-middle","text-gray-900","text-sm","font-medium"],[1,"py-4","px-4","border-b","border-gray-100","align-middle","text-orange-600","text-sm","font-semibold"],[1,"py-4","px-4","border-b","border-gray-100","align-middle"],[1,"flex","gap-2.5","justify-end"],["title","Ver detalle",1,"border","border-gray-300","bg-white","text-gray-900","rounded-lg","px-3.5","py-2","cursor-pointer","inline-flex","items-center","gap-2","transition-all","hover:-translate-y-0.5","hover:bg-gray-50","hover:border-gray-400","hover:shadow","text-xs","font-medium","whitespace-nowrap",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],[1,"py-12","px-6","text-center","text-gray-600"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","mx-auto","mb-4","text-blue-600"],[1,"m-0","mb-2","text-gray-900","font-semibold"],[1,"m-0","text-gray-600"],[1,"fixed","inset-0","z-[2000]","bg-black","bg-opacity-50","backdrop-blur-sm","flex","items-center","justify-center","p-4",3,"click"],[1,"w-full","max-w-4xl","bg-white","rounded-xl","shadow-xl","border","border-gray-200","max-h-[90vh]","overflow-y-auto",3,"click"],[1,"sticky","top-0","bg-gradient-to-r","from-blue-600","to-blue-700","text-white","p-5","rounded-t-xl"],[1,"flex","justify-between","items-center"],[1,"text-xl","font-bold"],[1,"text-white","hover:text-orange-300","transition-colors","p-2","rounded-lg","hover:bg-blue-800",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6","space-y-4"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"bg-gray-50","rounded-lg","p-4"],[1,"text-sm","text-gray-600","mb-1"],[1,"font-semibold","text-gray-900"],[1,"bg-orange-50","rounded-lg","p-4"],[1,"text-sm","text-orange-600","mb-1"],[1,"font-bold","text-orange-700","text-lg"],[1,"border-t","pt-4"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"overflow-x-auto"],[1,"w-full","border-collapse"],[1,"bg-gray-100"],[1,"text-left","text-xs","tracking-wider","uppercase","text-gray-600","py-3","px-4","border-b","border-gray-200","font-semibold"],[1,"divide-y","divide-gray-200"],["class","hover:bg-gray-50",4,"ngFor","ngForOf"],[1,"flex","justify-end","pt-4","border-t"],[1,"inline-flex","items-center","gap-2","px-4","py-2","bg-white","border","border-gray-300","text-gray-900","rounded-lg","cursor-pointer","font-medium","text-sm","transition-all","hover:-translate-y-0.5","hover:bg-gray-50","hover:border-gray-400","hover:shadow-md",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],[1,"hover:bg-gray-50"],[1,"py-3","px-4","text-sm","text-gray-900"],[1,"py-3","px-4","text-sm","text-gray-600"],[1,"py-3","px-4","text-sm","text-gray-900","font-semibold"]],template:function(i,o){if(i&1){let s=w();e(0,"div",1)(1,"header",2)(2,"div",3)(3,"div",4),g(),e(4,"svg",5),v(5,"path",6),t(),u(),e(6,"div")(7,"h1",7),n(8,"Historial de Ventas"),t(),e(9,"p",8),n(10,"Consulta y revisa el historial de todas tus ventas realizadas."),t()()()()(),e(11,"div",9)(12,"div",10),g(),e(13,"svg",11),v(14,"path",12),t(),u(),e(15,"span"),n(16,"REGISTROS"),t()()(),e(17,"div",13)(18,"input",14),k("ngModelChange",function(x){return d(s),E(o.filtroNombre,x)||(o.filtroNombre=x),m(x)}),c("input",function(){return d(s),m(o.filtrarPorNombre())}),t(),e(19,"input",15),k("ngModelChange",function(x){return d(s),E(o.filtroFecha,x)||(o.filtroFecha=x),m(x)}),c("change",function(){return d(s),m(o.filtrarPorFecha())}),t(),e(20,"button",16),c("click",function(){return d(s),m(o.limpiarFiltros())}),n(21," Limpiar "),t()(),e(22,"section",17),_(23,J,2,0,"div",18)(24,Q,17,1,"table",19)(25,U,7,0,"ng-template",null,0,j),t()(),_(27,Y,52,8,"div",20)}if(i&2){let s=M(26);a(18),C("ngModel",o.filtroNombre),a(),C("ngModel",o.filtroFecha),a(4),y("ngIf",o.loading),a(),y("ngIf",!o.loading&&o.ventas.length)("ngIfElse",s),a(3),y("ngIf",o.mostrandoDetalle)}},dependencies:[O,L,P,B,A,z,G,W],encapsulation:2})};export{q as HistorialComponent};
