import{a as w}from"./chunk-44D34TD6.js";import"./chunk-O5HRWX2F.js";import{Cb as E,Db as M,Eb as C,Ga as g,Hb as k,Ia as c,Ja as h,Ma as e,Na as t,Oa as s,Ra as v,W as x,Wa as i,Xa as S,Ya as p,db as b,ea as d,fa as m,fb as y,wa as l,xa as f}from"./chunk-SFQMZB6G.js";import{h as u}from"./chunk-FK42CRUA.js";var _=(o,n,r,a)=>({"bg-yellow-100 text-yellow-700":o,"bg-blue-100 text-blue-700":n,"bg-orange-100 text-orange-700":r,"bg-gray-100 text-gray-600":a});function I(o,n){if(o&1&&(e(0,"div",38),d(),e(1,"svg",39),s(2,"path",40),t(),i(3),t()),o&2){let r=v();l(3),p(" ",r.errorMessage," ")}}function T(o,n){o&1&&(e(0,"div",41)(1,"div",42),i(2,"Cargando informaci\xF3n de productos..."),t()())}function V(o,n){o&1&&(e(0,"div",43),d(),e(1,"svg",44),s(2,"path",45),t(),m(),e(3,"p",46),i(4,"A\xFAn no hay ventas registradas"),t(),e(5,"p",47),i(6,"No se puede calcular este ranking"),t()())}function G(o,n){if(o&1&&(e(0,"tr",54)(1,"td",55)(2,"div",56)(3,"span",57),i(4),t(),e(5,"span",58),i(6),t()()(),e(7,"td",59),i(8),t()()),o&2){let r=n.$implicit,a=n.index;l(3),c("ngClass",y(4,_,a===0,a===1,a===2,a>2)),l(),p(" ",a+1," "),l(2),S(r.nombre),l(2),p(" ",r.cantidad_total," ")}}function H(o,n){if(o&1&&(e(0,"div",48)(1,"table",49)(2,"thead",50)(3,"tr")(4,"th",51),i(5,"Producto"),t(),e(6,"th",52),i(7,"Cantidad"),t()()(),e(8,"tbody"),g(9,G,9,9,"tr",53),t()()()),o&2){let r=v();l(9),c("ngForOf",r.topProductos)}}function F(o,n){o&1&&(e(0,"div",41)(1,"div",42),i(2,"Cargando ventas por categor\xEDa..."),t()())}function j(o,n){o&1&&(e(0,"div",43),d(),e(1,"svg",44),s(2,"path",3),t(),m(),e(3,"p",46),i(4,"No hay datos suficientes"),t(),e(5,"p",47),i(6,"No se puede mostrar esta distribuci\xF3n"),t()())}function L(o,n){if(o&1&&(e(0,"div",62)(1,"div",63)(2,"span",64),i(3),t(),e(4,"span",65),i(5),t()(),e(6,"div",66),s(7,"div",67),t()()),o&2){let r=n.$implicit,a=v(2);l(3),p(" ",r.categoria||"Sin categor\xEDa"," "),l(2),p(" ",a.formatearMoneda(r.total)," "),l(2),h("width",a.getPorcentajeCategoria(r.total),"%")}}function N(o,n){if(o&1&&(e(0,"div",60),g(1,L,8,4,"div",61),t()),o&2){let r=v();l(),c("ngForOf",r.ventasPorCategoria)}}var P=class o{constructor(n){this.reportesService=n}loadingKPIs=!0;loadingTopProductos=!0;loadingCategorias=!0;errorMessage="";kpis={ventasHoy:0,ventasMes:0,ventasAnio:0,comprasMes:0,ticketPromedio:0};topProductos=[];ventasPorCategoria=[];ngOnInit(){return u(this,null,function*(){yield Promise.all([this.cargarKPIs(),this.cargarTopProductos(),this.cargarVentasPorCategoria()])})}cargarKPIs(){return u(this,null,function*(){this.loadingKPIs=!0,this.errorMessage="";try{let n=yield this.reportesService.getKPIs();this.kpis={ventasHoy:Number(n.ventasHoy)||0,ventasMes:Number(n.ventasMes)||0,ventasAnio:Number(n.ventasAnio)||0,comprasMes:Number(n.comprasMes)||0,ticketPromedio:Number(n.ticketPromedio)||0}}catch(n){console.error(n),this.errorMessage="Error al cargar KPIs gerenciales."}finally{this.loadingKPIs=!1}})}cargarTopProductos(){return u(this,null,function*(){this.loadingTopProductos=!0;try{let n=yield this.reportesService.getTopProductos(10);this.topProductos=(n||[]).map(r=>({nombre:r.nombre,cantidad_total:Number(r.cantidad_total)||0}))}catch(n){console.error(n)}finally{this.loadingTopProductos=!1}})}cargarVentasPorCategoria(){return u(this,null,function*(){this.loadingCategorias=!0;try{let n=yield this.reportesService.getVentasPorCategoria();this.ventasPorCategoria=(n||[]).map(r=>({categoria:r.categoria||"Sin categor\xEDa",total:Number(r.total)||0}))}catch(n){console.error(n)}finally{this.loadingCategorias=!1}})}formatearMoneda(n){return n?`S/ ${n.toFixed(2)}`:"S/ 0.00"}getMaxTotalCategorias(){return this.ventasPorCategoria.length?Math.max(...this.ventasPorCategoria.map(n=>n.total)):0}getPorcentajeCategoria(n){let r=this.getMaxTotalCategorias();return r?n/r*100:0}static \u0275fac=function(r){return new(r||o)(f(w))};static \u0275cmp=x({type:o,selectors:[["app-gerencial"]],standalone:!0,features:[b],decls:89,vars:12,consts:[[1,"p-4","md:p-6","space-y-6"],[1,"text-2xl","font-bold","text-gray-800","flex","items-center","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],[1,"text-gray-600","mt-1"],["class","p-4 rounded-lg bg-red-50 border border-red-200 text-sm text-red-700 flex items-center gap-2",4,"ngIf"],[1,"flex","items-center","gap-2","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-600"],[1,"text-sm","font-semibold","text-gray-500","uppercase","tracking-wide"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-5","gap-4"],[1,"bg-white","border","border-gray-200","rounded-xl","shadow-sm","p-5","flex","flex-col","hover:shadow-md","transition-shadow"],[1,"flex","items-center","gap-2","mb-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-xs","font-semibold","text-gray-500","uppercase","tracking-wide"],[1,"text-2xl","font-bold","text-gray-900","mb-1"],[1,"text-xs","text-gray-500"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"text-2xl","font-bold","text-blue-700","mb-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-emerald-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"],[1,"text-2xl","font-bold","text-emerald-700","mb-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-orange-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"],[1,"text-2xl","font-bold","text-orange-600","mb-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-purple-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"text-2xl","font-bold","text-purple-700","mb-1"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"bg-white","border","border-gray-200","rounded-xl","shadow-sm","p-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"],[1,"text-xs","text-gray-500","mb-4"],["class","flex items-center justify-center py-8",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","overflow-x-auto",4,"ngIf"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"],["class","space-y-4",4,"ngIf"],[1,"p-4","rounded-lg","bg-red-50","border","border-red-200","text-sm","text-red-700","flex","items-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex","items-center","justify-center","py-8"],[1,"text-sm","text-gray-500"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","mx-auto","mb-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"],[1,"text-sm","font-medium","text-gray-500"],[1,"text-xs","text-gray-400","mt-1"],[1,"overflow-x-auto"],[1,"w-full","text-sm"],[1,"bg-gray-100","text-xs","text-gray-600"],[1,"px-4","py-3","text-left","font-semibold"],[1,"px-4","py-3","text-center","font-semibold"],["class","border-b hover:bg-gray-50 transition-colors",4,"ngFor","ngForOf"],[1,"border-b","hover:bg-gray-50","transition-colors"],[1,"px-4","py-3"],[1,"flex","items-center","gap-3"],[1,"inline-flex","items-center","justify-center","w-6","h-6","text-xs","font-bold","rounded-full",3,"ngClass"],[1,"text-gray-800","font-medium"],[1,"px-4","py-3","text-center","font-semibold","text-blue-600"],[1,"space-y-4"],["class","space-y-2",4,"ngFor","ngForOf"],[1,"space-y-2"],[1,"flex","items-center","justify-between","text-sm"],[1,"font-medium","text-gray-800"],[1,"text-gray-700","font-semibold"],[1,"w-full","bg-gray-100","rounded-full","h-2.5","overflow-hidden"],[1,"h-2.5","rounded-full","bg-gradient-to-r","from-blue-500","to-blue-400","transition-all","duration-300"]],template:function(r,a){r&1&&(e(0,"div",0)(1,"div")(2,"h1",1),d(),e(3,"svg",2),s(4,"path",3),t(),i(5," Reporte Gerencial "),t(),m(),e(6,"p",4),i(7,"Visi\xF3n general del desempe\xF1o de la ferreter\xEDa: ventas, compras y productos clave."),t()(),g(8,I,4,1,"div",5),e(9,"section")(10,"div",6),d(),e(11,"svg",7),s(12,"path",3),t(),m(),e(13,"h2",8),i(14,"Indicadores Clave"),t()(),e(15,"div",9)(16,"div",10)(17,"div",11),d(),e(18,"svg",12),s(19,"path",13),t(),m(),e(20,"p",14),i(21,"Ventas Hoy"),t()(),e(22,"h3",15),i(23),t(),e(24,"p",16),i(25," Total vendido en el d\xEDa actual "),t()(),e(26,"div",10)(27,"div",11),d(),e(28,"svg",17),s(29,"path",18),t(),m(),e(30,"p",14),i(31,"Ventas del Mes"),t()(),e(32,"h3",19),i(33),t(),e(34,"p",16),i(35," Suma de todas las ventas del mes actual "),t()(),e(36,"div",10)(37,"div",11),d(),e(38,"svg",20),s(39,"path",21),t(),m(),e(40,"p",14),i(41,"Ventas del A\xF1o"),t()(),e(42,"h3",22),i(43),t(),e(44,"p",16),i(45," Total acumulado en el a\xF1o calendario "),t()(),e(46,"div",10)(47,"div",11),d(),e(48,"svg",23),s(49,"path",24),t(),m(),e(50,"p",14),i(51,"Compras del Mes"),t()(),e(52,"h3",25),i(53),t(),e(54,"p",16),i(55," Monto invertido en reposici\xF3n de stock "),t()(),e(56,"div",10)(57,"div",11),d(),e(58,"svg",26),s(59,"path",27),t(),m(),e(60,"p",14),i(61,"Ticket Promedio"),t()(),e(62,"h3",28),i(63),t(),e(64,"p",16),i(65," Promedio por venta en el mes "),t()()()(),e(66,"section",29)(67,"div",30)(68,"div",6),d(),e(69,"svg",7),s(70,"path",31),t(),m(),e(71,"h2",8),i(72,"Top Productos M\xE1s Vendidos"),t()(),e(73,"p",32),i(74,"Ordenados por cantidad vendida (acumulado hist\xF3rico)"),t(),g(75,T,3,0,"div",33)(76,V,7,0,"div",34)(77,H,10,1,"div",35),t(),e(78,"div",30)(79,"div",6),d(),e(80,"svg",7),s(81,"path",36),t(),m(),e(82,"h2",8),i(83,"Ventas por Categor\xEDa"),t()(),e(84,"p",32),i(85,"Distribuci\xF3n del total vendido por l\xEDnea de producto"),t(),g(86,F,3,0,"div",33)(87,j,7,0,"div",34)(88,N,2,1,"div",37),t()()()),r&2&&(l(8),c("ngIf",a.errorMessage),l(15),p(" ",a.formatearMoneda(a.kpis.ventasHoy)," "),l(10),p(" ",a.formatearMoneda(a.kpis.ventasMes)," "),l(10),p(" ",a.formatearMoneda(a.kpis.ventasAnio)," "),l(10),p(" ",a.formatearMoneda(a.kpis.comprasMes)," "),l(10),p(" ",a.formatearMoneda(a.kpis.ticketPromedio)," "),l(12),c("ngIf",a.loadingTopProductos),l(),c("ngIf",!a.loadingTopProductos&&a.topProductos.length===0),l(),c("ngIf",!a.loadingTopProductos&&a.topProductos.length>0),l(9),c("ngIf",a.loadingCategorias),l(),c("ngIf",!a.loadingCategorias&&a.ventasPorCategoria.length===0),l(),c("ngIf",!a.loadingCategorias&&a.ventasPorCategoria.length>0))},dependencies:[k,E,M,C]})};export{P as GerencialComponent};
